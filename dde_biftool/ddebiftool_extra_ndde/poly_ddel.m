function dp=poly_ddel(m,c);

% function dp=poly_ddel(m,c);
% INPUT:
%       m lagrange degree
%       c evaluation point in [0,1]
% OUTPUT:
%       dp values of second derivative of lagrange polynomials through 0:1/m:1 at c

% (c) David Barton 19/11/2005
% Adapted from
% (c) DDE-BIFTOOL v. 1.00, 15/03/2000

if m==1
  dp(1)=0;
  dp(2)=0;
elseif m==2
  dp(1)=4.0;
  dp(2)=-8.0;
  dp(3)=4.0;
elseif m==3
  dp(1)=-27*c+18;
  dp(2)=81*c-45;
  dp(3)=-81*c+36;
  dp(4)=27*c-9;
elseif m==4
  dp(1)=(21.33333333333333*(c-0.5)*(c-1.)+21.33333333333333*(c-0.75)*(c-1.)+21.33333333333333*(c-0.25)*(c-0.5)+21.33333333333333*(c-0.5)*(c-0.75)+21.33333333333333*(c-0.25)*(c-1.)+21.33333333333333*(c-0.25)*(c-0.75));
  dp(2)=(-85.33333333333333*(c-0.5)*(c-1.)-85.33333333333333*c*(c-1.)-85.33333333333333*(c-0.5)*(c-0.75)-85.33333333333333*c*(c-0.75)-85.33333333333333*c*(c-0.5)-85.33333333333333*(c-0.75)*(c-1.));
  dp(3)=(128.*c*(c-0.25)+128.*c*(c-0.75)+128.*c*(c-1.)+128.*(c-0.75)*(c-1.)+128.*(c-0.25)*(c-1.)+128.*(c-0.25)*(c-0.75));
  dp(4)=(-85.33333333333333*c*(c-0.25)-85.33333333333333*c*(c-1.)-85.33333333333333*(c-0.25)*(c-1.)-85.33333333333333*(c-0.25)*(c-0.5)-85.33333333333333*c*(c-0.5)-85.33333333333333*(c-0.5)*(c-1.));
  dp(5)=(21.33333333333333*(c-0.25)*(c-0.75)+21.33333333333333*(c-0.25)*(c-0.5)+21.33333333333333*c*(c-0.5)+21.33333333333333*c*(c-0.25)+21.33333333333333*c*(c-0.75)+21.33333333333333*(c-0.5)*(c-0.75));
else
  t = [0:m]/m;
  for j = 1:(m + 1)
    dp(j) = 0;
    for k = 1:(m + 1)
	  if (k ~= j)
		df = 0;
		for l = 1:(m + 1)
		  if ((l ~= k) && (l ~= j))
			f = 1;
			for r = 1:(m + 1)
			  if ((r ~= l) && (r ~= k) && (r ~= j))
				f = f*(c - t(r))/(t(j) - t(r));
			  end;
			end;
			df = df + f/(t(j) - t(l));
		  end;
		end;
		dp(j) = dp(j) + df/(t(j) - t(k));
	  end;
    end;
  end;
end;

return;
